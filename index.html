<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Simple Rhythm Game</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="container">
      <h1>
        <span class="logo" aria-hidden="true">
          <svg width="28" height="28" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M5 8h2v8H5V8Zm12 0h2v8h-2V8Z" fill="#bbb"/>
            <rect x="7" y="10.5" width="10" height="3" rx="1.5" fill="#e0e0e0"/>
            <rect x="9.25" y="9.75" width="5.5" height="4.5" rx="2.25" fill="#9e9e9e"/>
          </svg>
        </span>
        Ovice Kintore Rhythm (4キー: D F J K)
      </h1>
      <!-- Screen 1: Start -->
      <section id="screen-start" class="screen active">
        <div class="panel center hero-panel">
          <h2 class="title-pop">トレーニング開始</h2>
          <p class="muted">筋トレリズムに合わせて叩こう！</p>
          <div class="hero-media">
            <img src="assets/kintoregazou.jpg" alt="筋トレ画像" class="hero-img" />
          </div>
          <div class="buttons">
            <button id="btnGoSong" class="btn-hero">ゲームスタート</button>
          </div>
        </div>
      </section>

      <!-- Screen 2: Song Select -->
      <section id="screen-song" class="screen">
        <div class="controls">
          <div class="row">
            <label>曲を選択（assets 推奨）</label>
            <div class="song-buttons">
              <button id="useAssetsBtn" title="assets/ovicekintoresong1.mp3">assetsサンプル1</button>
              <button id="useAssetsBtn2" title="assets/ovicekintoresong2.mp3">assetsサンプル2</button>
            </div>
          </div>
          <div class="row">
            <label>URLで指定（GitHub Raw等）</label>
            <input id="urlInput" type="url" placeholder="https://raw.githubusercontent.com/user/repo/branch/path/song.mp3 または assets/ovicekintoresong1.mp3" />
          </div>
          <div class="row">
            <label>またはローカルMP3を選択</label>
            <input id="fileInput" type="file" accept="audio/mpeg,audio/mp3" />
          </div>
          <div class="row buttons">
            <button id="btnToLevel" class="accent">次へ（レベル選択）</button>
            <button id="btnBackStart">戻る</button>
          </div>
          <div id="status"></div>
        </div>
      </section>

      <!-- Screen 3: Level Select -->
      <section id="screen-level" class="screen">
        <div class="panel center">
          <h2>レベルを選択</h2>
          <div class="level-buttons">
            <button class="level" data-level="easy">EASY</button>
            <button class="level" data-level="normal">NORMAL</button>
            <button class="level" data-level="hard">HARD</button>
          </div>
          <div class="buttons">
            <button id="btnBackSong">曲選択へ戻る</button>
          </div>
        </div>
      </section>

      <!-- Screen 4: Game -->
      <section id="screen-game" class="screen">
        <div class="game-wrap">
          <canvas id="game" width="480" height="720"></canvas>
          <div class="keybar" id="keybar" aria-label="On-screen keys">
            <button class="key" data-lane="0" aria-label="Lane 1 (D)">D</button>
            <button class="key" data-lane="1" aria-label="Lane 2 (F)">F</button>
            <button class="key" data-lane="2" aria-label="Lane 3 (J)">J</button>
            <button class="key" data-lane="3" aria-label="Lane 4 (K)">K</button>
          </div>
          <div class="hud">
            <div>Score: <span id="score">0</span></div>
            <div>Combo: <span id="combo">0</span> / Max <span id="maxCombo">0</span></div>
            <div>Accuracy: <span id="acc">0.00%</span></div>
            <div>BPM(推定): <span id="bpm">-</span></div>
          </div>
        </div>
        <div class="controls">
          <div class="row buttons">
            <button id="pauseBtn" disabled>一時停止/再開</button>
            <button id="restartBtn" disabled>リスタート</button>
            <button id="btnBackLevel">レベル選択へ戻る</button>
          </div>
          <div class="hint">D / F / J / K でプレイ。タップもOK。</div>
        </div>
      </section>
    </div>

    <audio id="player" crossorigin="anonymous"></audio>
    <script src="script.js"></script>
  </body>
  </html>
