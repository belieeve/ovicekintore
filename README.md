# Rhythm Game (Auto Chart)

4キー(D, F, J, K)で遊べる簡易音ゲー。手持ちのMP3から譜面を自動生成します。

## 使い方

1. `index.html` をブラウザで開きます（ローカルでOK）。
2. 次のどちらかで音源を指定します。
   - GitHubに置いたMP3のRAW URLを入力欄に貼る
     - 例: `https://raw.githubusercontent.com/<user>/<repo>/<branch>/path/to/song.mp3`
   - ローカルのMP3ファイルを選択
   - リポジトリ内 `assets/ovicekintoresong1.mp3` / `assets/ovicekintoresong2.mp3` を利用（相対URL）
     - 「assetsサンプル1」「assetsサンプル2」ボタンでURL欄に自動入力
3. 「譜面を自動生成」を押すと、音源を解析してノーツが作成されます。
4. レベルを選択（EASY / NORMAL / HARD）。
5. ゲーム画面で「スタート」を押してプレイ開始。キーボード D / F / J / K で叩きます。
6. 「一時停止/再開」「リスタート」で制御できます。

注意:
- GitHubの通常のファイルページURLではなく「Raw」URLを使ってください（CORS対応済み）。
- 一部のMP3では解析結果がうまく出ない場合があります。

## 自動生成の仕組み（概要）

- Web Audio APIでデコードし、モノラル化した波形の短時間エネルギーの増加量からオンセット(立ち上がり)を検出。
- オンセット間隔のヒストグラムからBPMを推定（60〜200BPM、倍/半分テンポ補正を考慮）。
- 推定BPMが得られた場合は1/2拍グリッドに軽くスナップしてタイミングを整えます。
- 連続ノーツの最小間隔は約0.12秒に制限。
- 4レーンへ半ランダムに割り当て。

## 判定/スコア

- 判定幅: Perfect ±0.05s / Great ±0.09s / Good ±0.12s / Miss それ以外
- スコア: Perfect 1000 / Great 600 / Good 300（+コンボ補正）
- ComboはMissでリセット。精度(Accuracy)は簡易表示。

## デプロイ（公開方法）

どちらも静的サイトとしてそのまま公開できます。

- GitHub Pages: リポジトリのSettings → Pagesで`main`ブランチのルートを指定
- Vercel/Netlify: 新規プロジェクトでこのフォルダを選ぶだけ（ビルド不要）

同一オリジンの相対URL（例: `assets/sample.mp3`）はCORS設定不要で安定して再生できます。

## 今後の改善アイデア

- スペクトルフラックス/FFTベースのより高精度なオンセット検出
- 本格的なBPM/拍位置推定（ダウンビート検出、マルチテンポ対応）
- ロングノーツ/同時押し/パターン難易度設定
- エフェクト/SE/判定エフェクトの強化、モバイルタップ操作
- 成績画面や譜面エクスポート(JSON)対応
